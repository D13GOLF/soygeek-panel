<!-- templates/dashboard.html -->
{% extends "layout.html" %}
{% block content %}
<h1>Resumen General</h1>

<div class="dashboard-grid">
    <div class="card">
        <h3>Clientes Totales</h3>
        <p>{{ clientes_count }}</p>
    </div>
    <div class="card">
        <h3>Tareas Pendientes</h3>
        <p>{{ tareas_pendientes }}</p>
    </div>
    <div class="card">
        <h3>Tareas Completadas</h3>
        <p>{{ tareas_completadas }}</p>
    </div>
    <div class="card">
        <h3>Tareas Vencidas</h3>
        <p>{{ tareas_vencidas }}</p>
    </div>
    <div class="card">
        <h3>Hostings por vencer</h3>
        <p>{{ hostings_por_vencer }}</p>
    </div>
    <div class="card">
        <h3>Estado del Bot</h3>
        <p>
            {% if estado_bot == "Activo" %}
                <span class="bot-activo">游릭 Activo</span>
            {% else %}
                <span class="bot-inactivo">游댮 Inactivo</span>
            {% endif %}
        </p>
    </div>
</div>

<!-- Gr치fico de tareas -->
<div class="grafico-panel">
  <h3 style="text-align:center; color:#38bdf8;">游늷 Tareas Pendientes y Completadas</h3>
  <canvas id="graficoTareas" width="400" height="200"></canvas>
</div>

<!-- Gr치fico de clientes por mes -->
<div class="grafico-panel">
  <h3 style="text-align:center; color:#38bdf8;">游늱 Clientes Registrados por Mes</h3>
  <canvas id="graficoClientes" width="400" height="200"></canvas>
</div>

<!-- ChartJS -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
  const ctxTareas = document.getElementById('graficoTareas').getContext('2d');
  const graficoTareas = new Chart(ctxTareas, {
    type: 'doughnut',
    data: {
      labels: ['Pendientes', 'Completadas'],
      datasets: [{
        label: 'Estado de Tareas',
        data: [{{ tareas_pendientes }}, {{ tareas_completadas }}],
        backgroundColor: ['#f59e0b', '#10b981'],
        borderWidth: 1
      }]
    },
    options: {
      plugins: {
        legend: {
          labels: {
            color: '#fff',
            font: { size: 14 }
          }
        }
      }
    }
  });

  // Gr치fico de clientes por mes 游늳
  const ctxClientes = document.getElementById('graficoClientes').getContext('2d');
  const graficoClientes = new Chart(ctxClientes, {
    type: 'bar',
    data: {
      labels: {{ meses|tojson }},
      datasets: [{
        label: 'Clientes Nuevos',
        data: {{ clientes_mes|tojson }},
        backgroundColor: '#3b82f6',
        borderRadius: 6
      }]
    },
    options: {
      scales: {
        y: {
          ticks: { color: '#fff' },
          beginAtZero: true
        },
        x: {
          ticks: { color: '#fff' }
        }
      },
      plugins: {
        legend: {
          labels: {
            color: '#38bdf8',
            font: { weight: 'bold' }
          }
        }
      }
    }
  });
</script>
{% endblock %}
